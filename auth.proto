syntax = "proto3";

package auth;

import "types.proto";

option go_package = "/auth";



// Sign in
message SignInRequest {
  string username = 1;
  string password = 2;
}

message SignInResponse {
  types.User user = 1;
  string token = 2;
}

// Sign up
message SignUpRequest {
  string display_name = 1;
  string user_name = 2;
  optional string email = 3;
  string password = 4;
}

message SignUpResponse {
  types.User user = 1;
  string token = 2;
}

// Sign in as guest
message SignInAsGuestRequest {
  string display_name = 1;
}

message SignInAsGuestResponse {
  types.User user = 1;
  string token = 2;
  int64 expires_at = 3;
  int32 max_realms = 4;
}

message LogoutRequest {}
message LogoutResponse {}

message LogoutAllRequest {}
message LogoutAllResponse {
  int32 sessions_terminated = 1;
}

// Get current user info
message GetMeRequest {}
message GetMeResponse {
  types.User user = 1;
  int64 storage_used = 2;
  int64 storage_limit = 3;
}
